import{r,o as P,j as e}from"./index-BnojLncm.js";import{a as R}from"./index.esm-DcX4gvxN.js";import{C as I,a as O}from"./CCardBody-DTQSsj6y.js";import{C as U}from"./CCardHeader-4MH-jmpG.js";import{C as j}from"./CCol-BKubyUbC.js";import{C as v}from"./CFormSelect-BNrKeUl1.js";import{a as w}from"./CButton-DZZLU9l8.js";import{c as Y}from"./cil-print-CPAcfqxC.js";import{C as E,a as H,b as y,c,d as L,e as n}from"./CTable-DUzSWEfo.js";import"./CFormControlWrapper-BsYZPQpj.js";import"./CFormControlValidation-CuR5blZk.js";import"./CFormLabel-CCNaOWuY.js";const ee=()=>{const[t,B]=r.useState(new Date().getMonth()),[m,S]=r.useState(new Date().getFullYear().toString()),[o,i]=r.useState([]),[x,p]=r.useState([]),[u,N]=r.useState(!1),[g,b]=r.useState(!1),k=P(),d=l=>new Intl.NumberFormat("en-US").format(Number(l)),D=async()=>{if(!(!m||!t)){b(!0);try{const h=await(await fetch(`https://script.google.com/macros/s/AKfycbzk3C5Wsf3sGRwnkGuD5cylcb6pz8BDTB3lk1lSncBANB7L30NkN44M1PVUjjYbFtDV/exec?action=monthly-rent&year=${m}&month=${t}`)).json();if(h.length===0){setModalMessage("ไม่พบข้อมูล"),p([]);return}const A=h.map(a=>({year:a.ปี,month:a.เดือน,roomNo:a.ห้อง,rentPrice:d(a.ค่าเช่า),elecNew:a["มิเตอร์ไฟ (ใหม่)"],elecOld:a["มิเตอร์ไฟ (เก่า)"],elecBill:d(a.ค่าไฟ),waterNew:a["มิเตอร์น้ำ (ใหม่)"],waterOld:a["มิเตอร์น้ำ (เก่า)"],waterBill:d(a.ค่าน้ำ),netBill:d(a.รวม)}));p(A),i([]),N(!1)}catch(l){console.error("Error fetching data:",l)}finally{b(!1)}}},C=l=>{i(s=>s.includes(l)?s.filter(h=>h!==l):[...s,l])},T=()=>{i(u?[]:x.map(l=>l.roomNo)),N(!u)},F=()=>{if(o.length>0){let l=x.filter(s=>o.includes(s.roomNo));l=l.map(s=>({...s,monthThai:f[t-1].label})),k("/preview",{state:{selectedData:l}})}},f=[{value:"1",label:"มกราคม"},{value:"2",label:"กุมภาพันธ์"},{value:"3",label:"มีนาคม"},{value:"4",label:"เมษายน"},{value:"5",label:"พฤษภาคม"},{value:"6",label:"มิถุนายน"},{value:"7",label:"กรกฎาคม"},{value:"8",label:"สิงหาคม"},{value:"9",label:"กันยายน"},{value:"10",label:"ตุลาคม"},{value:"11",label:"พฤศจิกายน"},{value:"12",label:"ธันวาคม"}],M=[{value:"2024",label:"2024"}];return e.jsxs(I,{children:[e.jsx(U,{className:"d-flex justify-content-between align-items-center",children:e.jsx("h5",{className:"mb-0",children:"รายการค่าเช่าบ้าน"})}),e.jsxs(O,{children:[e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx(j,{md:2,className:"me-3",children:e.jsx(v,{value:m,onChange:l=>S(l.target.value),className:"me-2",children:M.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})}),e.jsx(j,{md:3,className:"me-3",children:e.jsx(v,{value:t,onChange:l=>B(l.target.value),className:"me-2",children:f.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})}),e.jsx(j,{md:1,className:"me-3",children:e.jsx(w,{color:"primary",onClick:D,disabled:g,style:{flex:"1 1 auto"},children:"ค้นหา"})})]}),g&&e.jsx("div",{children:"Loading..."}),e.jsx("div",{className:"mt-3",children:e.jsxs(w,{color:"secondary",onClick:F,disabled:o.length===0,children:[e.jsx(R,{icon:Y,customClassName:"icon",style:{marginRight:"8px"}}),"พิมพ์"]})}),e.jsxs(E,{hover:!0,children:[e.jsx(H,{children:e.jsxs(y,{children:[e.jsx(c,{scope:"col",children:e.jsx("input",{type:"checkbox",checked:u,onChange:T})}),e.jsx(c,{className:"center-align",scope:"col",children:"ห้อง"}),e.jsx(c,{className:"center-align",scope:"col",children:"ค่าเช่า"}),e.jsx(c,{className:"center-align",scope:"col",children:"มิเตอร์ไฟใหม่"}),e.jsx(c,{className:"center-align",scope:"col",children:"มิเตอร์ไฟเก่า"}),e.jsx(c,{className:"center-align",scope:"col",children:"ค่าไฟ"}),e.jsx(c,{className:"center-align",scope:"col",children:"มิเตอร์น้ำใหม่"}),e.jsx(c,{className:"center-align",scope:"col",children:"มิเตอร์น้ำใหม่"}),e.jsx(c,{className:"center-align",scope:"col",children:"ค่าน้ำ"}),e.jsx(c,{className:"center-align",scope:"col",children:"รวม"})]})}),e.jsx(L,{children:x.map((l,s)=>e.jsxs(y,{onClick:()=>C(l.roomNo),style:{cursor:"pointer"},children:[e.jsx(n,{children:e.jsx("input",{type:"checkbox",checked:o.includes(l.roomNo),onChange:()=>C(l.roomNo)})}),e.jsx(n,{className:"center-align",children:l.roomNo}),e.jsx(n,{className:"center-align",children:l.rentPrice}),e.jsx(n,{className:"center-align",children:l.elecNew}),e.jsx(n,{className:"center-align",children:l.elecOld}),e.jsx(n,{className:"center-align",children:l.elecBill}),e.jsx(n,{className:"center-align",children:l.waterNew}),e.jsx(n,{className:"center-align",children:l.waterOld}),e.jsx(n,{className:"center-align",children:l.waterBill}),e.jsx(n,{className:"center-align",children:l.netBill})]},s))})]})]})]})};export{ee as default};
